even n = if (n / 2) * 2 == n then 1 else 0;

infixr 8 ^;

(^) a b =
    if b == 0 then
        1
    else if even b then
        let half = (^) a (b / 2) in
            half * half
    else
        a * (^) a (b - 1);

main = 2 ^ 10;
